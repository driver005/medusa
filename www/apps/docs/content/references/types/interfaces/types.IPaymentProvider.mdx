import TypeList from "@site/src/components/TypeList"

# IPaymentProvider

## Methods

### initiatePayment

Make calls to the third-party provider to initialize the payment. For example, in Stripe this method is used to create a Payment Intent for the customer.

#### Parameters

<TypeList types={[{"name":"data","type":"[CreatePaymentProviderSession](../types/types.CreatePaymentProviderSession.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"context","type":"[PaymentProviderContext](types.PaymentProviderContext.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"billing_address","type":"Partial&#60;[AddressDTO](../types/types.AddressDTO.mdx)&#62;","description":"The payment's billing address.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"email","type":"`string`","description":"The customer's email.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"resource_id","type":"`string`","description":"The ID of the resource the payment is associated with i.e. the ID of the PaymentSession in Medusa","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"Partial&#60;[CustomerDTO](../CustomerTypes/interfaces/types.CustomerTypes.CustomerDTO.mdx)&#62;","description":"The customer associated with this payment.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"extra","type":"`Record<string, unknown>`","description":"The extra fields specific to the provider session.","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"amount","type":"`number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"currency_code","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}]}  sectionTitle="initiatePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[PaymentProviderSessionResponse](types.PaymentProviderSessionResponse.mdx) \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"Either the payment's data or an error object.","expandable":false,"children":[{"name":"PaymentProviderSessionResponse \\| PaymentProviderError","type":"[PaymentProviderSessionResponse](types.PaymentProviderSessionResponse.mdx) \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="initiatePayment"/>

### updatePayment

This method is used to update the payment session.

#### Parameters

<TypeList types={[{"name":"context","type":"[UpdatePaymentProviderSession](../types/types.UpdatePaymentProviderSession.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"context","type":"[PaymentProviderContext](types.PaymentProviderContext.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"billing_address","type":"Partial&#60;[AddressDTO](../types/types.AddressDTO.mdx)&#62;","description":"The payment's billing address.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"email","type":"`string`","description":"The customer's email.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"resource_id","type":"`string`","description":"The ID of the resource the payment is associated with i.e. the ID of the PaymentSession in Medusa","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"Partial&#60;[CustomerDTO](../CustomerTypes/interfaces/types.CustomerTypes.CustomerDTO.mdx)&#62;","description":"The customer associated with this payment.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"extra","type":"`Record<string, unknown>`","description":"The extra fields specific to the provider session.","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"data","type":"`Record<string, unknown>`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"amount","type":"`number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"currency_code","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}]}  sectionTitle="updatePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[PaymentProviderSessionResponse](types.PaymentProviderSessionResponse.mdx) \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"Either the payment's data or an error object.","expandable":false,"children":[{"name":"PaymentProviderSessionResponse \\| PaymentProviderError","type":"[PaymentProviderSessionResponse](types.PaymentProviderSessionResponse.mdx) \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="updatePayment"/>

### deletePayment

This method is used to perform any actions necessary before a Payment Session is deleted. The Payment Session is deleted in one of the following cases:

#### Parameters

<TypeList types={[{"name":"paymentSessionData","type":"`Record<string, unknown>`","description":"The `data` field of the Payment Session.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="deletePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Record&#60;string, unknown&#62; \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"Either an error object or an empty object.","expandable":false,"children":[{"name":"Record&#60;string, unknown&#62; \\| PaymentProviderError","type":"`Record<string, unknown>` \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="deletePayment"/>

### authorizePayment

This method is used to authorize payment using the Payment Session.
You can interact with a third-party provider and perform any actions necessary to authorize the payment.

The payment authorization might require additional action from the customer before it is declared authorized. Once that additional action is performed,
the `authorizePayment` method will be called again to validate that the payment is now fully authorized. So, make sure to implement it for this case as well, if necessary.

:::note

The payment authorization status is determined using the [getPaymentStatus](types.IPaymentProvider.mdx#getpaymentstatus) method. If the status is `requires_more`, then it means additional actions are required
from the customer.

:::

#### Parameters

<TypeList types={[{"name":"paymentSessionData","type":"`Record<string, unknown>`","description":"The `data` field of the payment session.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"`Record<string, unknown>`","description":"The context of the authorization.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="authorizePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[PaymentProviderAuthorizeResponse](../types/types.PaymentProviderAuthorizeResponse.mdx) \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"The authorization details or an error object.","expandable":false,"children":[{"name":"PaymentProviderAuthorizeResponse \\| PaymentProviderError","type":"[PaymentProviderAuthorizeResponse](../types/types.PaymentProviderAuthorizeResponse.mdx) \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="authorizePayment"/>

### capturePayment

This method is used to capture the payment amount. This is typically triggered manually by the store operator from the admin.

You can utilize this method to interact with the third-party provider and perform any actions necessary to capture the payment.

#### Parameters

<TypeList types={[{"name":"paymentSessionData","type":"`Record<string, unknown>`","description":"The `data` field of the Payment for its first parameter.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="capturePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Record&#60;string, unknown&#62; \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"Either an error object or a value that's stored in the `data` field of the Payment.","expandable":false,"children":[{"name":"Record&#60;string, unknown&#62; \\| PaymentProviderError","type":"`Record<string, unknown>` \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="capturePayment"/>

### refundPayment

This method is used to refund a payment. This is typically triggered manually by the store operator from the admin. The refund amount might be the total amount or part of it.

You can utilize this method to interact with the third-party provider and perform any actions necessary to refund the payment.

#### Parameters

<TypeList types={[{"name":"paymentSessionData","type":"`Record<string, unknown>`","description":"The `data` field of a Payment.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"refundAmount","type":"`number`","description":"the amount to refund.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="refundPayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Record&#60;string, unknown&#62; \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"Either an error object or a value that's stored in the `data` field of the Payment.","expandable":false,"children":[{"name":"Record&#60;string, unknown&#62; \\| PaymentProviderError","type":"`Record<string, unknown>` \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="refundPayment"/>

### retrievePayment

This method is used to provide a uniform way of retrieving the payment information from the third-party provider.
For example, in Stripe’s Payment Provider this method is used to retrieve the payment intent details from Stripe.

#### Parameters

<TypeList types={[{"name":"paymentSessionData","type":"`Record<string, unknown>`","description":"The `data` field of a Payment Session. Make sure to store in the `data` field any necessary data that would allow you to retrieve the payment data from the third-party provider.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="retrievePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Record&#60;string, unknown&#62; \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"The payment's data, typically retrieved from a third-party provider.","expandable":false,"children":[{"name":"Record&#60;string, unknown&#62; \\| PaymentProviderError","type":"`Record<string, unknown>` \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="retrievePayment"/>

### cancelPayment

This method is used to cancel a payment. This method is typically triggered by one of the following situations:

You can utilize this method to interact with the third-party provider and perform any actions necessary to cancel the payment.

#### Parameters

<TypeList types={[{"name":"paymentSessionData","type":"`Record<string, unknown>`","description":"The `data` field of the Payment.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="cancelPayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Record&#60;string, unknown&#62; \\| [PaymentProviderError](types.PaymentProviderError.mdx)&#62;","optional":false,"defaultValue":"","description":"Either an error object or a value that's stored in the `data` field of the Payment.","expandable":false,"children":[{"name":"Record&#60;string, unknown&#62; \\| PaymentProviderError","type":"`Record<string, unknown>` \\| [PaymentProviderError](types.PaymentProviderError.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}]}  sectionTitle="cancelPayment"/>

### getPaymentStatus

This method is used to get the status of a Payment or a Payment Session.

#### Parameters

<TypeList types={[{"name":"paymentSessionData","type":"`Record<string, unknown>`","description":"The `data` field of a Payment as a parameter. You can use this data to interact with the third-party provider to check the status of the payment if necessary.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="getPaymentStatus"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[PaymentSessionStatus](../enums/types.PaymentSessionStatus.mdx)&#62;","optional":false,"defaultValue":"","description":"The status of the Payment or Payment Session.","expandable":false,"children":[{"name":"PaymentSessionStatus","type":"[PaymentSessionStatus](../enums/types.PaymentSessionStatus.mdx)","optional":false,"defaultValue":"","description":"The status of a payment session.","expandable":false,"children":[{"name":"AUTHORIZED","type":"`\"authorized\"`","description":"The payment is authorized.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"PENDING","type":"`\"pending\"`","description":"The payment is pending.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"REQUIRES_MORE","type":"`\"requires_more\"`","description":"The payment requires an action.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"ERROR","type":"`\"error\"`","description":"An error occurred while processing the payment.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"CANCELED","type":"`\"canceled\"`","description":"The payment is canceled.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]}  sectionTitle="getPaymentStatus"/>

### getWebhookActionAndData

The method is called when å webhook call for this particular provider is received.

The method is responsible for normalizing the received event and provide

#### Parameters

<TypeList types={[{"name":"data","type":"`object`","description":"object containing provider id and data from the provider","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Parsed webhook body","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"rawData","type":"`string` \\| `Buffer`","description":"Raw request body","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"headers","type":"`Record<string, unknown>`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]},{"name":"data.data","type":"`Record<string, unknown>`","description":"Parsed webhook body","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data.rawData","type":"`string` \\| `Buffer`","description":"Raw request body","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data.headers","type":"`Record<string, unknown>`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="getWebhookActionAndData"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[WebhookActionResult](../types/types.WebhookActionResult.mdx)&#62;","optional":false,"defaultValue":"","description":"The method is called when å webhook call for this particular provider is received.\n\nThe method is responsible for normalizing the received event and provide","expandable":false,"children":[{"name":"WebhookActionResult","type":"[WebhookActionResult](../types/types.WebhookActionResult.mdx)","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"WebhookActionResult","type":"`object` \\| `object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}]}]}  sectionTitle="getWebhookActionAndData"/>
